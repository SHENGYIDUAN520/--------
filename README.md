# 智能陪护监控平台

## 项目介绍
这是一个基于Flask的智能陪护监控平台，用于老人健康监控和远程看护。

## 开发进度

### 2023-07-10
- 初始化项目
- 创建基本Flask应用框架
- 实现用户认证API

### 2023-07-15
- 添加老人信息API
- 添加摄像头API
- 添加设备状态API

### 2023-07-20
- 添加报警事件API
- 添加视频记录API
- 添加数据统计API

### 2023-07-25
- 实现WebSocket视频流功能
- 添加视频接收服务

### 2023-07-30
- 完善前端界面
- 实现实时监控功能

### 2024-05-26
- 修复代码错误：删除了重复定义的video_receiver函数
- 修复了"name 'latest_frame' is assigned to before global declaration"语法错误
- 确保全局变量正确声明并使用

## 错误修复记录

1. 问题：在app.py中，video_receiver函数被重复定义了三次，导致出现语法错误：
   ```
   SyntaxError: name 'latest_frame' is assigned to before global declaration
   ```

2. 解决方法：
   - 删除了第808行和第933行开始的重复函数定义
   - 只保留了第一个正确定义的video_receiver函数
   - 确保global语句正确放置在变量使用之前

## 运行方法
1. 确保安装了所有依赖：
   ```
   pip install flask flask-cors flask-sock numpy opencv-python
   ```

2. 运行服务器：
   ```
   python app.py
   ```

3. 服务器将在5001端口启动，视频接收服务在5000端口监听

## 注意事项
- 视频接收服务默认监听5000端口，与K230庐山派设备对接
- WebSocket服务用于向前端分发视频流
- 前端页面通过WebSocket接收实时视频流

# 智能陪护监控平台开发记录

## 2024-04-22 视频监控功能更新 (2)

1. 将视频列表中的"示例视频X"改为直接显示视频文件名
2. 修改视频信息显示部分，使用"视频文件名"替代"视频名称"
3. 保持原始文件名显示，不再去除文件扩展名

## 2024-04-22 视频监控功能更新 (1)

1. 优化UI界面，删除了视频页面中的"选择视频源"下拉窗口
2. 简化了视频源切换方式，只通过侧边栏视频列表进行选择
3. 修复了一些CSS样式问题

## 2024-04-21 视频监控功能更新

1. 将实时视频监控功能修改为本地视频播放功能
2. 在video.html和detail.html中都实现了本地视频播放
3. 添加了以下功能:
   - 播放/暂停控制
   - 视频列表选择
   - 截图功能
   - 全屏播放
   - 音量控制

## 使用说明

1. 需要在static/videos目录中放置视频文件，命名为demo1.mp4, demo2.mp4, demo3.mp4
2. 点击播放按钮开始播放视频
3. 可以通过视频列表或下拉选择框切换不同视频
4. 支持截图功能，点击截图按钮可将当前画面保存为PNG图片

## 下一步计划

1. 实现视频进度条控制功能
2. 添加更多的视频格式支持
3. 优化视频加载性能
4. 实现视频列表缩略图预览功能
